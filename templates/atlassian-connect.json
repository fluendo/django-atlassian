{
    "name": "Fluendo Atlassian Extensions",
    "description": "Fluendo Atlassian Extensions",
    "key": "com.fluendo.jira-addon",
    "baseUrl": "{{base_url}}",
    "vendor": {
        "name": "Fluendo S.A.",
        "url": "https://fluendo.com/"
    },
    "authentication": {
        "type": "jwt"
    },
    "lifecycle": {
        "installed": "{% url 'django-atlassian-installed' %}"
    },
    "scopes": [
        "read", "write"
    ],
    "apiVersion": 1,
    "modules": {
        "generalPages": [{
            "url": "{% url 'atlassian-hello-world' %}",
            "key": "hello-world",
            "location": "system.top.navigation.bar",
            "name": {
                "value": "Fluendo"
            },
            "conditions": [{
                "condition": "user_is_logged_in"
            }]
        }],
        "webhooks": [{
                "name": "Jira Issue Updated",
                "key": "jira-issue-updated",
                "event": "jira:issue_updated",
                "url": "{% url 'atlassian-issue-updated' %}",
                "excludeBody": false,
                "scopes": [
                    "read", "write"
                ]
            },
            {
                "name": "Jira Issue Created",
                "key": "jira-issue-created",
                "event": "jira:issue_created",
                "url": "{% url 'atlassian-issue-created' %}",
                "excludeBody": false,
                "scopes": [
                    "read", "write"
                ]
            }
        ],
        "jiraIssueFields": [{
                "key": "accumulated-progress",
                "description": {
                    "value": "Total amount in hours of an issue in progress state"
                },
                "type": "number",
                "name": {
                    "value": "Accumulated Progress"
                }
            },
            {
                "key": "feedback-votes",
                "description": {
                    "value": "Number of positive or negative votes given to a feature"
                },
                "type": "number",
                "name": {
                    "value": "Feedback Votes"
                }
            }
        ],
        "jiraEntityProperties": [
            {
                "key": "jira-issue-customers-indexing",
                "name": {
                    "value": "Customers index",
                    "i18n": "customers.index"
                },
                "entityType": "issue",
                "keyConfigurations": [{
                    "propertyKey": "customers",
                    "extractions": [{
                            "objectName": "customer",
                            "type": "text"
                        },
                        {
                            "objectName": "customer_id",
                            "type": "number"
                        }
                    ]
                }],
                "conditions": [{
                    "condition": "user_is_logged_in"
                }]
            },
            {
                "key": "jira-issue-leads-indexing",
                "name": {
                    "value": "Leads index",
                    "i18n": "leads.index"
                },
                "entityType": "issue",
                "keyConfigurations": [{
                    "propertyKey": "leads",
                    "extractions": [{
                            "objectName": "product",
                            "type": "text"
                        },
                        {
                            "objectName": "project",
                            "type": "text"
                        },
                        {
                            "objectName": "email",
                            "type": "text"
                        }
                    ]
                }]
            }
        ],
        "webPanels": [{
            "url": "/atlassian/customers-view?key={issue.key}",
            "location": "atl.jira.view.issue.right.context",
            "weight": 50,
            "name": {
                "value": "Fluendo"
            },
            "key": "fluendo-issue-customer",
            "conditions": [{
                "condition": "user_is_logged_in"
            }]
        }],
        "jiraWorkflowPostFunctions": [{
                "key": "postfunction-increment-field",
                "description": {
                    "value": "Increments an issue field by one"
                },
                "name": {
                    "value": "Increment Issue Field"
                },
                "create": {
                    "url": "{% url 'atlassian-postfunction-increment-create' %}"
                },
                "view": {
                    "url": "{% url 'atlassian-postfunction-increment-view' %}{postFunction.config}/"
                },
                "edit": {
                    "url": "{% url 'atlassian-postfunction-increment-create' %}{postFunction.config}/"
                },
                "triggered": {
                    "url": "{% url 'atlassian-postfunction-increment-triggered' %}"
                }
            },
            {
                "key": "postfunction-decrement-field",
                "description": {
                    "value": "Decrement an issue field by one"
                },
                "name": {
                    "value": "Decrement Issue Field"
                },
                "create": {
                    "url": "{% url 'atlassian-postfunction-decrement-create' %}"
                },
                "view": {
                    "url": "{% url 'atlassian-postfunction-decrement-view' %}{postFunction.config}/"
                },
                "edit": {
                    "url": "{% url 'atlassian-postfunction-decrement-create' %}{postFunction.config}/"
                },
                "triggered": {
                    "url": "{% url 'atlassian-postfunction-decrement-triggered' %}"
                }
            }
        ],
        "jiraProjectPages": [{
                "key": "sales-accounts",
                "name": {
                    "value": "Accounts"
                },
                "url": "{% url 'sales-accounts-list-view' %}?projectKey=${project.key}",
                "iconUrl": "/static/atlassian/img/contacts.png",
                "weight": 1,
                "conditions": [
                    {
                        "condition": "user_is_logged_in"
                    },
                    {
                        "condition": "entity_property_exists",
                        "params":{
                            "entity": "project",
                            "propertyKey": "fluendo-accounts"
                        }
                    }
                ]
            },
            {
                "key": "sales-contacts",
                "name": {
                    "value": "Contacts"
                },
                "url": "{% url 'sales-contacts-list-view' %}?projectKey=${project.key}",
                "iconUrl": "/static/atlassian/img/contacts.png",
                "weight": 1,
                "conditions": [
                    {
                        "condition": "user_is_logged_in"
                    },
                    {
                        "condition": "entity_property_exists",
                        "params":{
                            "entity": "project",
                            "propertyKey": "fluendo-contacts"
                        }
                    }
                ]
            }
        ]
    }
}